<%- include ./layouts/head.ejs %>
<%- include ./layouts/header.ejs %>

<body class="body-index">  
  <main>

    <div class="contenedor-principal-productos">
      <div class="ultimos-productos contenedor">
        <h2>ÚLTIMOS AGREGADOS</h2>
        
        <% if (productos && productos.length > 0) { %>
          <div class="contenedor-productos">
            <% productos.forEach(function(producto) { %>
              <div class="card card-ultimos">
                <div class="cover__card">
                  <% if (producto.imagenes && producto.imagenes.length > 0) { %>
                    <img src="/uploads/productos/<%= producto.imagenes[0].imagen %>" alt="<%= producto.nombre %>">
                  <% } else { %>
                    <img src="/ruta/valida/a/imagen/por/defecto.jpg" alt="<%= producto.nombre %>">
                  <% } %>
                </div>
                <div class="titulo-producto">
                  <h3 class="nombre"><%= producto.nombre %></h3>
                </div>
                <hr>
                <div class="categoria-producto">
                  <h5 class="categoria"><%= producto.categoria_nombre || "Sin categoría" %></h5>
                </div>
                <div class="precio-producto">
                  <p class="precio"><%= new Intl.NumberFormat('es-CL', { style: 'currency', currency: 'CLP' }).format(producto.precio_venta || 0) %></p>
                </div>
              </div>
            <% }); %>
          </div>
        <% } else { %>
          <p>No se encontraron productos en esta categoría.</p>
        <% } %>

      </div>
  
      <div class="ofertas-productos contenedor-ofertas">
        <h2>OFERTAS</h2>

        <% if (productosOferta && productosOferta.length > 0) { %>
          <div class="contenedor-carrousel-ofertas">
            <button class="flecha-izquierda-ofertas"><i class="fas fa-chevron-left"></i></button>
            <div class="contenedor-productos-ofertas">
              <% productosOferta.forEach(function(oferta) { %>
                <div class="card-oferta">
                  <% if (oferta.imagenes && oferta.imagenes.length > 0) { %>
                    <div class="cover-card-oferta">
                      <% oferta.imagenes.forEach(function(imagen) { %>
                        <img src="/uploads/productos/<%= imagen.imagen %>" alt="<%= oferta.nombre %>">
                      <% }); %>
                    </div>
                  <% } else { %>
                    <div class="cover-card-oferta">
                      <img src="/ruta/valida/a/imagen/por/defecto.jpg" alt="<%= oferta.nombre %>">
                    </div>
                  <% } %>
                  <div class="titulo-producto-oferta">
                    <h3 class="nombre-oferta"><%= oferta.nombre %></h3>
                  </div>
                  <hr>
                  <div class="categoria-producto-oferta">
                    <h5 class="categoria-oferta"><%= oferta.categoria_nombre || "Sin categoría" %></h5>
                  </div>
                  <div class="precio-producto-oferta">
                    <p class="precio-oferta"><%= new Intl.NumberFormat('es-CL', { style: 'currency', currency: 'CLP' }).format(oferta.precio_venta || 0) %></p>
                  </div>
                </div>
              <% }); %>
            </div>
            <button class="flecha-derecha-ofertas"><i class="fas fa-chevron-right"></i></button>
          </div>
        <% } else { %>
          <p>No hay ofertas disponibles.</p>
        <% } %>

      </div>
    </div>

  </main>

  <%- include ./layouts/footer.ejs %>
  <script src="js/index.js"></script> 
</body>
</html>
